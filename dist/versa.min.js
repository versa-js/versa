class e{node=null;basename="base";base=null;constructor(e,t="",n){this.node=e,this.base=n||e,this.basename=t}html(e){return this.node.innerHTML=e,this}append(e){if("string"==typeof e||e instanceof String){let t=document.createElement("div");t.innerHTML=e;for(const e of t.children)this.node.appendChild(e);return this}return this.node.appendChild(el),this}state(e,t){if(!this.node)return console.warn(`.${this.basename}__${e} not found, cant set ${e} state`),this;let n=this.node.classList,s=`is-${e}`;return t?(n.add(s),this):(n.remove(s),this)}is(e){return this.node.classList.contains(`is-${e}`)}element(t,n){return new e((n?this.base:this.node).querySelector(`.${this.basename}__${t}`),this.basename,this.base)}elements(t,n){let s=[];for(let a of(n?this.base:this.node).querySelectorAll(`.${this.basename}__${t}`))s.push(new e(a,this.basename,this.base));return s}}const t=new class{mutationObserver=null;modules={};events=[];external_events={};addEvent(e){-1==this.events.indexOf(e)&&(document.addEventListener(e,(e=>this.handleEvent(e)),!0),this.events.push(e))}addExternalEvent(e,t){this.addEvent(e),this.external_events[e]=this.external_events[e]||[],this.external_events[e].push(t)}addModule(e){this.modules[e.name]=e}getModule(e){return this.modules[e]}handleEvent(e){e.target&&e.target.tagName&&-1==["HTML"].indexOf(e.target.tagName)&&(e.target==document.body?this.handleGlobalEvent(e):this.handleComponentEvent(e))}handleGlobalEvent(t){let n=document.querySelectorAll("[data-component]");for(let s of n){let n=s.dataset.component,a=this.modules[n],l=`_${t.type}`;a.events&&a.events[l]&&a.events[l].call(a,new e(s,a.name),t)}this.handleExternalEvent(t)}handleExternalEvent(e){const t=this.external_events[e.type];t&&t.forEach((t=>{t(e)}))}handleComponentEvent(t){let n=t.composedPath().filter((e=>e.tagName&&-1==["HTML"].indexOf(e.tagName))),s=n.filter((e=>e.dataset.component));for(let a of s){let s=this.modules[a.dataset.component];for(let l in s.events[t.type]){let o=a.querySelectorAll(`.${l}`);if(o)for(let i of o)-1!=n.indexOf(i)&&s.events[t.type][l].call(s,new e(a,s.name),new e(i,s.name),t)}}}};class n{name="component";elements={};global={};events={};install(e){}bootstrap(){for(let e in this.elements)for(let n in this.elements[e])this.register(`${this.name}__${e}`,n,this.elements[e][n]),t.addEvent(n);for(let e in this.global)this.events[`_${e}`]=this.global[e],t.addEvent(e)}register(e,t,n){this.events[t]||(this.events[t]={}),this.events[t][e]||(this.events[t][e]={}),this.events[t][e]=n}static addModule(e){Object.keys(e.events).length||e.bootstrap(),t.addModule(e)}}const s=()=>{for(const n of document.querySelectorAll("[data-component]:not([versa-installed])")){const s=n.dataset.component,a=t.getModule(s);if(a)try{a.install.call(a,new e(n,a.name)),n.setAttribute("versa-installed",!0)}catch(e){n.setAttribute("versa-installed",!0),console.error(e)}else import(`/versa/${s}/module.js`).then((s=>{let a=new s.default;t.addModule(a);try{a.bootstrap(),a.install.call(a,new e(n,a.name)),n.setAttribute("versa-installed",!0)}catch(e){n.setAttribute("versa-installed",!0),console.error(e)}}))}};function a(e,t){const n=new Event(e);n.payload=t,document.body.dispatchEvent(n)}function l(e,n){t.addExternalEvent(e,n)}new MutationObserver(((e,t)=>{let n=!1;for(let t of e){if("childList"!==t.type||!t.addedNodes.length)return;n=!0}n&&s()})).observe(document.body,{childList:!0,subtree:!0}),setTimeout(s);export{e as BEM,n as Component,n as default,a as emit,l as on};